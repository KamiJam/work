<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta charset="utf-8">
		<title>活动帖</title>

		<!--
             width=device-width：让文档的宽度与设备的宽度保持一致，且文档最大的宽度比例是1.0
             initial-scale=1：初始的缩放比例
             maximum-scale=1：允许用户缩放到的最大比例（对应还有个minimum-scale）
             user-scalable=no：不允许用户手动缩放
             -->
		<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
		<!--
             telephone=no：禁止自动将页面中的数字识别为电话号码
             address=no：禁止自动地址转为链接
             email=no：禁止自动将email转为链接
             -->
		<meta name="format-detection" content="telephone=no,address=no,email=no" />
		<!-- 强制将页面布局为一列 -->
		<meta name="mobileOptimized" content="width" />
		<!-- 申明页面是移动友好的 -->
		<meta name="handheldFriendly" content="true" />
		<!-- 允许用户使用全屏模式浏览 -->
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<!-- 当用户使用全屏浏览时，将状态条设置为黑色 -->
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		
		<link rel="stylesheet" type="text/css" href="activity.css" />
		<script type="text/javascript" src="jquery.min.js"></script>
		<style type="text/css">
			#nickname {
				position: absolute;
				top: 9px;
				left: 56px;
				/*    padding-left:0px;*/
				height: 18px;
				line-height: 18px;
				font-size: 13px;
				color: #527EAD;
				/*    width:100%;*/
				overflow: hidden;
			}
			
			.post-top {
				position: relative;
			}
			
			#circlename {
				color: #527EAD;
				height: 18px;
				line-height: 18px;
				font-size: 13px;
				position: static;
				top: 0;
			}
			
			#time {
				padding-right: 4px;
			}
			
			.vname {
				display: none;
				position: absolute;
				width: 14px !important;
				height: 14px !important;
				top: 34.5px !important;
				left: 33px !important;
				z-index: 11111111;
			}
			img{
				max-width: 100%;
			}
			#richItem{
			overflow: hidden;
            color: #666;
			}
			#richItem *{
				max-width: 100%;
			}
			#richItem table{
				max-width: 100% !important;
			}
		</style>

	</head>

	<body style="">
		<section class="b-top" id="detail">
			<div class="post">
				<div class="">
					<div class="post-top">
						<img src="jq.png" alt="" id="imga" class="imga">
						<img src="" class="vname" alt="">

						<div class="author" id="nickname"></div>
						<div class="name">

							<span class="time" id="time"> </span>
							<span id="sends">发布于</span>
							<span class="circlename" id="circlename"></span>

						</div>

					</div>

				</div>
				<div style="" id="ac_img"><img style="width:100%" id="imgurl" src="jq.png" /> </div>

				<div id="ac_title"></div>
				<div class="infoD">
					<div class="imgicon"><img src="start_time.png"></div>
					<div class="contentInfo" id="startDate"></div>
				</div>
				<div class="infoD">
					<div class="imgicon"><img src="ac_address.png"></div>

					<div class="contentInfo" id="ac_addr"></div>
				</div>
				<div class="infoD">
					<div class="imgicon"><img src="ac_mobile.png"></div>

					<a class="contentInfo" id="ac_mobile"></a>
				</div>
				<div class="infoD">
					<div class="imgicon"><img src="ac_master.png"></div>
					<div class="contentInfo" id="ac_master"></div>
				</div>

				<div id="ac_master_info"></div>

				<div class="infoT" id="ac_member">

					<div class="titleInfo" id="id_apply_num">已报名</div>

					<div class="viewAll">查看全部<i class="more-icon"></i></div>

				</div>

				<div id="imgdiv" class="imgdiv1">

					<span class="img-head">
						<div class="imgcontainer">
							<img  class="head-img" id="mpic1" src="jq.png" alt="">
							<img class="vip-icon" src="v.png" alt="" style="display: none;">
						</div>
						<span></span>
					</span>
					<span class="img-head">
						<div class="imgcontainer">
							<img  class="head-img" id="mpic2" src="jq.png" alt="">
							<img class="vip-icon" src="v.png" alt="" style="display: none;">
						</div>
						<span></span>
					</span>
					<span class="img-head">
						<div class="imgcontainer">
							<img  class="head-img" id="mpic3" src="jq.png" alt="">
							<img class="vip-icon" src="v.png" alt="" style="display: none;">
						</div>
						<span></span>
					</span>
					<span class="img-head">
						<div class="imgcontainer">
							<img  class="head-img" id="mpic4" src="jq.png" alt="">
							<img class="vip-icon" src="v.png" alt="" style="display: none;">
						</div>
						<span></span>
					</span>
					<span class="img-head">
						<div class="imgcontainer">
							<img  class="head-img" id="mpic5" src="jq.png" alt="">
							<img class="vip-icon" src="v.png" alt="" style="display: none;">
						</div>
						<span></span>
					</span>
					<!--<span class="img-head"><img class="head-img" id="mpic3" src="jq.png" alt="">诸葛明</span>
					<span class="img-head"><img class="head-img" id="mpic4" src="jq.png" alt="">诸葛孔明</span>
					<span class="img-head"><img class="head-img" id="mpic5" src="jq.png" alt="">诸葛孔明</span>-->

				</div>
				
				
				<div class="infoT" id="ac_block">

					<div class="titleInfo">活动公告</div>
					<!--<div class="viewAll">查看全部</div>-->
				</div>

				<div class="noticeC" id="ac_block_content">
					
				</div>
				<!--<div class="noticeT" id="ac_block_time">
					
				</div>-->
				
				<!--直播-->
				<div class="infoT" id="ac_live">
					<div class="titleInfo">活动直播</div>
				</div>
				<div class="infoAlive ov-h">
					<div class="liveimg-c">
						<img  class="liveimg" src="jq.png"/>
						<img  class="liveicon" src="live2.png"/>
					</div>
					<div class="livetitle"></div>
					<div class="fr" id="enterlive">进入直播<i class="more-icon"></i></div>
				</div>
				<div style="height: 10px;background-color: white;margin-bottom: 10px;"></div>
				<!--<div class="dline"></div>-->
				<!--活动详情-->
				<div class="infoDetail">
					<div class="tName">活动详情</div>
					<!--<div class="flag"></div>-->
				</div>
				<div class="acrichtext" id="richItem">
					
				</div>

				<!--<div class="bbbottom">
					<div class="block-btn">
						<span h class="btn-apply">我要报名</span>
						<div class="divop">
						</div>

					</div>

				</div>-->
				
				<!--底部按键-->
				<!--<div class="bottom-btns">
					<div class="bb-btn btn-collect "></div>
					<div class="bb-btn btn-zan active"></div>
					<div class="btn-apply">
						我要报名
						<p class="ba-tips">(一小时后开始报名)</p>
					</div>
				</div>-->
		</section>

		<script>
			window.onerror = function(err) {
				log(err)
			}

			function connectWebViewJavascriptBridge(callback) {
				if(window.WebViewJavascriptBridge) {
					callback(WebViewJavascriptBridge)
				} else {
					document.addEventListener('WebViewJavascriptBridgeReady', function() {
						callback(WebViewJavascriptBridge)
					}, false)
				}
			}

			var uniqueId = 1

			function log(data) {

				/*
				if(data.isflag == 1 || data.isflag == "1") {
					$('.vname').show();
				} else {
					$('.vname').hide();
				}*/


	            if (data.QFlag != "undefined" && data.QFlag != "") {
	                $('.vname').attr("src", data.QFlag);
	                $('.vname').show();
	            } else {
	                $('.vname').hide();
	            }

				//alert(data.username);

				if(data.username != "undefined") {
					
					$(".imga").attr("src", "" + data.imga + "");
                    
                    if(!data.username){
                        $("#nickname").html("用户已被删除");
                    }else{
                        $("#nickname").html(data.username);
                    }
                    
					$("#time").html(data.time);
					$("#circlename").html(data.circlename);
					$("#imgurl").attr("src", "" + data.imgurl + "");
					$("#ac_title").html(data.title);
					
					//起止时间
					if(!data.startDate || !data.endDate){
						$("#startDate").parent().hide();
					}else{
						$("#startDate").html(data.startDate+"~"+data.endDate);
					}
					
					//地址
					if(data.ac_addr){
						$("#ac_addr").html(data.ac_addr);
					}else{
						$("#ac_addr").parent().hide();
					}
					
					//手机号码
					if(data.ac_mobile){
						$("#ac_mobile").html(data.ac_mobile);
					}else{
						$("#ac_mobile").parent().hide();
					}
					
					//主办方
					if(data.ac_master){
						$("#ac_master").html("主办方: " + data.ac_master);
						$("#ac_master_info").html(data.ac_master_info);
					}else{
						$("#ac_master").parent().hide();
					}
					
					//处理报名头像
					if(data.applynum){
						$("#id_apply_num").html("已报名"+ data.applynum);

						var ucount = 0;
						if(data.mpic1 == "-1") {
							$("#mpic1").parent().parent().remove();
	
						} else {
							$("#mpic1").attr("src", "" + data.mpic1 + "");
							if(data.flag1 && Number(data.flag1) == 1){
								$("#mpic1").next(".vip-icon").show();
							}
							$("#mpic1").parent().next("span").html(data.name1);
							ucount++;
						}
	
						if(data.mpic2 == "-1") {
							$("#mpic2").parent().parent().remove();
						} else {
							$("#mpic2").attr("src", "" + data.mpic2 + "");
							if(data.flag2 && Number(data.flag2) == 1){
								$("#mpic2").next(".vip-icon").show();
							}
							$("#mpic2").parent().next("span").html(data.name2);
							ucount++;
						}
	
						if(data.mpic3 == "-1") {
							$("#mpic3").parent().parent().remove();
	
						} else {
							if(data.flag3 && Number(data.flag3) == 1){
								$("#mpic3").next(".vip-icon").show();
							}
	
							$("#mpic3").attr("src", "" + data.mpic3 + "");
							$("#mpic3").parent().next("span").html(data.name3);
							ucount++;
						}
	
						if(data.mpic4 == "-1") {
							$("#mpic4").parent().parent().remove();
	
						} else {
							if(data.flag1 && Number(data.flag4) == 1){
								$("#mpic4").next(".vip-icon").show();
							}
							$("#mpic4").attr("src", "" + data.mpic4 + "");
							$("#mpic4").parent().next("span").html(data.name4);
							ucount++;
						}
	
						if(data.mpic5 == "-1") {
							$("#mpic5").parent().parent().remove();
	
						} else {
							if(data.flag5 && Number(data.flag5) == 1){
								$("#mpic5").next(".vip-icon").show();
							}
							$("#mpic5").attr("src", "" + data.mpic5 + "");
							$("#mpic5").parent().next("span").html(data.name5);
							ucount++;
						}
	
						if(ucount == 0) {
							$("#imgdiv").removeClass("imgdiv1");
							$("#imgdiv").addClass("imgdiv0");
							document.getElementById("imgdiv").style.height = "0px";
						}
					}else{
						$("#ac_member").hide();
						$("#imgdiv").hide();
					}
					
					
					//活动公告
					$("#ac_block_content").html(data.acblock);
					$("#ac_block_time").html(data.acblocktime);
					
					//直播详情
					if(data.livepostid == "-1" || data.livepostid == -1) {
//						$("#ac_live").remove();
//						$(".infoAlive").remove();
						$("#ac_live").hide();
						$(".infoAlive").next("div").hide();
						$(".infoAlive").hide();
					} else {
						$(".infoAlive .livetitle").html(data.liveposttile);
						$(".infoAlive .liveimg-c .liveimg").attr("src",data.livepostImg);
					}
					
					$("#richItem").html(data.richitem);
					if(data.username == "酒圈官方") {
						//$("#nickname").removeClass("author");
						//$("#nickname").addClass("authoroffical");
						
					}

					
					

//					$("#title").html(data.title);

					
					$("#content").html(data.content);
					$(".content").html(data.content);

					//alert($(".imga").attr("src"));

					// alert(data.imga);

					
					//报名
//					if(data.applystatus == 0 || data.applystatus == "0") {
//						$(".btn-apply").html("我要报名");
//						$(".btn-apply").css("backgroundColor", "#30ac63");
//					} else {
//						if(data.applystatus == 1 || data.applystatus == "1") {
//							$(".btn-apply").html("打开活动嘉宾证");
//							$(".btn-apply").css("backgroundColor", "#527EAD");
//						} else if(data.applystatus == 2 || data.applystatus == "2") {
//							$(".btn-apply").html("审核中");
//							$(".btn-apply").css("backgroundColor", "#f19b2c");
//							// $(".btn-apply").addClass("applyIng");
//						} else {
//							$(".btn-apply").html("您已被拒绝,请联系活动举办方");
//							$(".btn-apply").css("backgroundColor", "#FF2200");
//
//						}
//
//					}



					//document.getElementById("iconuser").style.top = "10px";

					if(data.isFromAdmin == 1 || data.isFromAdmin == "1") {
						//$("#sends").html("");

					}

					//  alert($(".imga").attr("src"));

					$("a").bind("click", function() {

						var link = $(this).attr("link");
						var title = $(this).html();

						jump(link, title);

					});

					$("#richItem img").bind("click", function() {

						var url = $(this).attr("src");

						viewurl(url);

					});

					$("#ac_img img").bind("click", function() {

						var url = $(this).attr("src");

						viewurl(url);

					});

				}

			}

			var obj = {
				username: "123",
				circlename: "123",
				time: "123",
				avatar: "1231231231"
			}

			//log(obj);

			var objbridge;

			function jump(url, title) {
				//alert(url);
				//alert(title);

				var obj = {
					title: title,
					url: url
				};

				objbridge.callHandler('jumpurlCallback', obj, function(response) {});

			}

			function viewurl(url) {
				//alert(url);
				//alert(title);

				var obj = {
					url: url
				};

				objbridge.callHandler('jumppicCallback', obj, function(response) {});

			}

			connectWebViewJavascriptBridge(function(bridge) {
				//初始化bridge
				bridge.init(function(message, responseCallback) {})

				objbridge = bridge;

				//注册响应方法
				bridge.registerHandler('testJavascriptHandler', function(data, responseCallback) {
					log(data)
				})

				//注册响应方法
				bridge.registerHandler('applyJavascriptHandler', function(data, responseCallback) {

//					if(data.js_join == 0) {
//						$(".btn-apply").html("我要报名");
//						$(".btn-apply").css("backgroundColor", "#30ac63");
//					} else {
//						if(data.js_join == 1) {
//							$(".btn-apply").html("打开活动嘉宾证");
//							$(".btn-apply").css("backgroundColor", "#527EAD");
//						} else {
//							$(".btn-apply").html("审核中");
//							$(".btn-apply").css("backgroundColor", "#f19b2c");
//
//						}
//
//					}

				})

				var l = document.getElementById("detail").offsetHeight;
				// alert(l);
				bridge.callHandler('initCallback', l, function(response) {});

				function geth() {
					var l1 = document.getElementById("detail").offsetHeight;

					//alert(l1);
					bridge.callHandler('testObjcCallback', l1, function(response) {});

				}
				var t1 = window.setInterval(geth, 500);

				$("#nickname").bind("click", function() {
					bridge.callHandler('nicknameCallback', "", function(response) {});
				});

				$(".imga").bind("click", function() {
					bridge.callHandler('imgnameCallback', "", function(response) {});
				});

				$("#circlename").bind("click", function() {
					bridge.callHandler('circlenameCallback', "", function(response) {});
				});

				$("#ac_block").bind("click", function() {

					// alert("公告");

					bridge.callHandler('acblockCallback', "", function(response) {});
				});

				$("#ac_block_content").bind("click", function() {

					// alert("公告");

					bridge.callHandler('acblockCallback', "", function(response) {});
				});

				$("#ac_block_time").bind("click", function() {

					// alert("公告");

					bridge.callHandler('acblockCallback', "", function(response) {});
				});

				$("#ac_member").bind("click", function() {

					// alert("参与人数");
					bridge.callHandler('memberCallback', "", function(response) {});
				});

				$("#imgdiv").bind("click", function() {

					// alert("参与人数");
					bridge.callHandler('memberCallback', "", function(response) {});
				});

				$("#ac_live").bind("click", function() {

					// alert("直播贴");
					bridge.callHandler('livepostCallback', "", function(response) {});
				});
				
				$("#enterlive").bind("click", function() {

					// alert("直播贴");
					bridge.callHandler('livepostCallback', "", function(response) {});
				});
				
				$(".btn-apply").bind("click", function() {

					//alert("报名");
					bridge.callHandler('applyCallback', "", function(response) {});
				});

				$("#btn-phone").bind("click", function() {

					//alert("手机");
					bridge.callHandler('mobileCallback', "", function(response) {});
				});
				
				$("#ac_mobile").bind("click", function() {

					//alert("手机");
					bridge.callHandler('mobileCallback', "", function(response) {});
				});

				$("#btn-share").bind("click", function() {

					//alert("手机");
					bridge.callHandler('shareCallback', "", function(response) {});
				});

			})
			
			function timestampToDate(stamp){
				var date = new Date(stamp);
				return (date.getMonth()+1) +"月"+date.getDate()+"号 "+date.getHours()+":"+date.getMinutes();
			}
		</script>
	</body>

</html>
