
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
            <title>图文话题</title>
            
            <!--
             width=device-width：让文档的宽度与设备的宽度保持一致，且文档最大的宽度比例是1.0
             initial-scale=1：初始的缩放比例
             maximum-scale=1：允许用户缩放到的最大比例（对应还有个minimum-scale）
             user-scalable=no：不允许用户手动缩放
             -->
            <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
            <!--
             telephone=no：禁止自动将页面中的数字识别为电话号码
             address=no：禁止自动地址转为链接
             email=no：禁止自动将email转为链接
             -->
            <meta name="format-detection" content="telephone=no,address=no,email=no" />
            <!-- 强制将页面布局为一列 -->
            <meta name="mobileOptimized" content="width" />
            <!-- 申明页面是移动友好的 -->
            <meta name="handheldFriendly" content="true" />
            <!-- 允许用户使用全屏模式浏览 -->
            <meta name="apple-mobile-web-app-capable" content="yes" />
            <!-- 当用户使用全屏浏览时，将状态条设置为黑色 -->
            <meta name="apple-mobile-web-app-status-bar-style" content="black" />
            
            <link rel="stylesheet" type="text/css" href="post.css" />
            
            <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
            <style type="text/css">
                
                </style>
            
            </head>
    <body style="">
        <section class="b-top" id="detail">
            <div class="post">
                <div class="post-top">
                    <img src="" alt="" id＝"imga" class="imga" >
                        
                        
                        <div class="circlename" id="circlename" ></div>
                        
                        <div class="name">
                            
                            <span class="author" id="nickname" ></span>
                            <span id="sends">发布于</span>
                            
                            <span class="time"  id="time"> <span/>
                                
                                </div>
                        
                        
                        
                        
                        
                        
                        </div>
                
            </div>
                <div class="acrichtext" id="richItem">
                    
                    <h1>这是 H1 标题似懂非懂舒服的是非得失分段收费电视放的是非得失的身份</h1><h2>这是 H2 标题</h2><blockquote>这是引用的内容这是引用的内容这是引用的内容这是引用的内容这是引用的内容这是引用的内容这是引用的内容</blockquote><p><span class=\"ql-size-huge\">这是字体大小 HUGE</span></p><p><span class=\"ql-size-large\">LARGE </span></p><p>NORMAL</p><p><span class=\"ql-size-small\">SMALL </span></p><p><br></p><p>左对齐</p><p class=\"ql-align-center\">居中显示</p><p class=\"ql-align-right\">右对齐</p><hr class=\"ql-hr\" style=\"height:0px; margin-top:10px; margin-bottom:10px;\"><p class=\"ql-align-justify\">平铺开</p><p><strong>加粗字体</strong></p><p><em>斜体</em></p><p><s>划除</s></p><p><u>下划线</u></p><p><span style=\"color: rgb(0, 102, 204);\">字体颜色</span></p><p><span style=\"color: rgb(68, 68, 68); background-color: rgb(0, 102, 204);\">背景颜色   </span></p><hr class=\"ql-hr\" style=\"height:0px; margin-top:10px; margin-bottom:10px;\"><p><br></p><p><a href=\"www.google.com \" target=\"_blank\">www.google.com </a> </p><hr class=\"ql-hr\" style=\"height:0px; margin-top:10px; margin-bottom:10px;\"><p><br></p><ul><li>bullet points 1</li><li>bullet points 2</li><li>bullet points 3</li></ul><hr class=\"ql-hr\" style=\"height:0px; margin-top:10px; margin-bottom:10px;\"><p><br></p><ol><li>number 1 </li><li>number 2</li><li>number 3</li></ol><p> </p><hr class=\"ql-hr\" style=\"height:0px; margin-top:10px; margin-bottom:10px;\"><p><img src=\"http://jiuquandata.b0.upaiyun.com/2016/09/20/upload_1f4b40a83148b7c2ea02953a73faaa73.jpg!richimg\"></p><p><br></p>
                    
                </div>
                
                <div  id="postiteminfo">
                    <div class="pro-img">
                        <img class="producturl" style="opacity: 1; transition: opacity 0.5s ease-in;" src="">
                            </div>
                    
                    <div id='pcontent'>12313123123</div>
                    
                </div>
                
                
            </div>
        </section>
        
        <script>
            window.onerror = function(err) {
                log(err)
            }
        
        function connectWebViewJavascriptBridge(callback) {
            if (window.WebViewJavascriptBridge) {
                callback(WebViewJavascriptBridge)
            } else {
                document.addEventListener('WebViewJavascriptBridgeReady', function() {
                                          callback(WebViewJavascriptBridge)
                                          }, false)
            }
        }
        
        var uniqueId = 1
        function log(data) {
            
            
            
            //alert(data.username);
            
            if(data.username != "undefined")
            {
                $("#nickname").html(data.username);
                if(data.username == "酒圈官方")
                {
                   // $("#nickname").removeClass("author");
                   // $("#nickname").addClass("authoroffical");
                    
                }
                
                $("#circlename").html(data.circlename);
                $("#time").html(data.time);
                
                $("#title").html(data.title);
                $("#content").html(data.content);
                $(".content").html(data.content);
                $("#richItem").html(data.richitem);
                $(".imga").attr("src",""+data.imga+"");
                
                $(".producturl").attr("src",""+data.producturl+"");
                
                $("#pcontent").html("<span class='ptitle'>产品名称:</span>"+data.productname);
                // $(".p-name").html(data.productname);
                //alert($(".imga").attr("src"));
                
                // alert(data.imga);
                //  $(".imga").attr("src",""+data.imga+"");
                
                //  alert($(".imga").attr("src"));
                
                
                if(data.isFromAdmin == 1 || data.isFromAdmin == "1")
                {
                   // $("#sends").html("");
                    
                }
                
                $("a").bind("click",function(){
                            
                            
                            
                            var link =  $(this).attr("link");
                            var title =  $(this).html();
                            
                            jump(link,title);
                            
                            });
                            
                            
                            $("#richItem img").bind("click",function(){
                                                    
                                                    
                                                    var url =  $(this).attr("src");
                                                    
                                                    viewurl(url);
                                                    
                                                    
                                                    });
                                                    
                                                    
                                                    
            }
            
            
            
        }
        
        var obj = {username:"123",circlename:"123",time:"123",
            avatar:"1231231231"
        }
        
        //log(obj);
        
        
        var objbridge;
        
        function jump(url,title)
        {
            //alert(url);
            //alert(title);
            
            var obj = {title:title,url:url};
            
            objbridge.callHandler('jumpurlCallback', obj, function(response) {});
            
        }
        
        function viewurl(url)
        {
            //alert(url);
            //alert(title);
            
            var obj = {url:url};
            
            objbridge.callHandler('jumppicCallback', obj, function(response) {});
            
        }
        
        
        connectWebViewJavascriptBridge(function(bridge) {
                                       //初始化bridge
                                       bridge.init(function(message, responseCallback) {})
                                       
                                       
                                       objbridge = bridge;
                                       //注册响应方法
                                       bridge.registerHandler('testJavascriptHandler', function(data, responseCallback) {
                                                              log(data)
                                                              })
                                       
                                       
                                       
                                       $("#postiteminfo").bind("click",function(){
                                                               bridge.callHandler('productCallback', "", function(response) {});
                                                               });
                                       
                                       $("#nickname").bind("click",function(){
                                                           bridge.callHandler('nicknameCallback', "", function(response) {});
                                                           });
                                       
                                       $(".imga").bind("click",function(){
                                                       bridge.callHandler('imgnameCallback', "", function(response) {});
                                                       });
                                       
                                       $("#circlename").bind("click",function(){
                                                             bridge.callHandler('circlenameCallback', "", function(response) {});
                                                             });
                                       
                                       var l =document.getElementById("detail").offsetHeight;
                                       //alert(l);
                                       bridge.callHandler('initCallback', l, function(response) {});
                                       
                                       var x =0;
                                       
                                       function geth(){
                                       
                                       
                                       
                                       var l1 =document.getElementById("detail").offsetHeight;
                                       
                                       
                                       if(l1==l)
                                       {
                                       x++;
                                       
                                       if(x==3)
                                       clearInterval(t1);
                                       
                                       return;
                                       
                                       }
                                       
                                       x=0;
                                       
                                       l = l1;
                                       
                                       
                                       //alert(l1);
                                       bridge.callHandler('testObjcCallback', l1, function(response) {});
                                       
                                       }
                                       var t1 = window.setInterval(geth,500);
                                       
                                       
                                       
                                       })
            </script>
    </body>
</html>
